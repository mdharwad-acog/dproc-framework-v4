<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DProc - Framework Architecture</title>
    <style>
        :root {
            --font-family-display: Arial, sans-serif;
            --font-weight-display: 600;
            --font-family-content: Arial, sans-serif;
            --font-weight-content: 400;
            --font-size-content: 16px;
            --line-height-content: 1.4;
            --color-bg-base: #0f172a;
            --color-bg-elevated: #020617;
            --color-bg-surface: #1e293b;
            --color-bg-muted: #334155;
            --color-text-primary: #f1f5f9;
            --color-text-secondary: #cbd5e1;
            --color-text-muted: #94a3b8;
            --color-text-accent: #38bdf8;
            --color-primary: #38bdf8;
            --color-primary-foreground: #0f172a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family-content);
            font-weight: var(--font-weight-content);
            font-size: var(--font-size-content);
            line-height: var(--line-height-content);
            background-color: var(--color-bg-base);
            color: var(--color-text-primary);
            overflow-x: hidden;
        }

        .slide {
            width: 960px;
            height: 540px;
            margin: 0 auto 20px;
            display: flex;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            background-color: var(--color-bg-base);
            color: var(--color-text-primary);
        }

        .row { flex-direction: row; }
        .col { flex-direction: column; }
        .center {
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .space-between { justify-content: space-between; }
        .items-center { align-items: center; }
        .items-start { align-items: flex-start; }
        .items-end { align-items: flex-end; }
        .fill-width { flex: 1; }
        .fill-height { flex: 1; display: flex; flex-direction: column; }

        .gap-sm { gap: 0.5rem; }
        .gap-md { gap: 1rem; }
        .gap-lg { gap: 1.5rem; }
        .gap-xl { gap: 2rem; }

        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .p-8 { padding: 2rem; }
        .p-12 { padding: 3rem; }
        .p-16 { padding: 4rem; }

        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-6 { margin-top: 1.5rem; }
        .mt-8 { margin-top: 2rem; }

        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-family-display);
            font-weight: var(--font-weight-display);
            line-height: 1.2;
            margin: 0;
        }

        h1 { font-size: 3rem; }
        h2 { font-size: 2.25rem; }
        h3 { font-size: 1.75rem; }
        h4 { font-size: 1.5rem; }
        h5 { font-size: 1.25rem; }
        h6 { font-size: 1rem; }

        .text-lg { font-size: 1.125rem; }
        .text-base { font-size: 1rem; }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }

        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .font-bold { font-weight: 700; }

        ul, ol {
            margin-left: 2rem;
            line-height: 1.8;
        }

        ul li { list-style: disc; }
        ol li { list-style: decimal; }
        li { margin-bottom: 0.75rem; }
        li:last-child { margin-bottom: 0; }

        .slide-title {
            background-color: var(--color-bg-elevated);
        }

        .slide-content {
            background-color: var(--color-bg-base);
        }

        .slide-content h2 {
            color: var(--color-text-accent);
        }

        code {
            background-color: #1e293b;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            color: #7dd3fc;
        }
    </style>
</head>
<body class="theme-dark">

    <!-- Slide 1: Title -->
    <section class="slide p-16 col center slide-title">
        <h1 class="text-4xl mb-4" style="color: #38bdf8;">DProc Framework</h1>
        <p class="text-2xl" style="color: #cbd5e1;">Architecture Overview</p>
        <p class="text-sm mt-8" style="color: #94a3b8;">How the system works internally</p>
    </section>

    <!-- Slide 2: Core Concept -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">The Core Idea</h2>
        <div class="fill-height">
            <ul class="text-lg" style="color: #cbd5e1;">
                <li>Pipelines process data and generate reports</li>
                <li>Each pipeline has a processor, prompts, and templates</li>
                <li>System coordinates: data processing → LLM → report generation</li>
                <li>Everything is file-based, no database required</li>
            </ul>
        </div>
    </section>

    <!-- Slide 3: Pipeline Structure -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">Pipeline Directory Structure</h2>
        <div class="fill-height">
            <ul class="text-lg" style="color: #cbd5e1;">
                <li><code>spec.yml</code> - Input/output definitions</li>
                <li><code>config.yml</code> - LLM & execution settings</li>
                <li><code>processor.ts</code> - Data fetching logic</li>
                <li><code>prompts/</code> - AI instructions</li>
                <li><code>templates/</code> - Report formats (HTML, MD, PDF)</li>
            </ul>
        </div>
    </section>

    <!-- Slide 4: Key Components (Part 1) -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">Key Components: Execution</h2>
        <div class="fill-height">
            <ul class="text-lg" style="color: #cbd5e1;">
                <li><strong>ReportExecutor</strong> - Orchestrates entire pipeline</li>
                <li><strong>Queue (BullMQ)</strong> - Redis-backed job queue</li>
                <li><strong>ExecutionRepository</strong> - Stores job history</li>
                <li><strong>LLMProvider</strong> - Handles Claude, GPT-4, Gemini</li>
            </ul>
        </div>
    </section>

    <!-- Slide 5: Key Components (Part 2) -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">Key Components: Rendering</h2>
        <div class="fill-height">
            <ul class="text-lg" style="color: #cbd5e1;">
                <li><strong>TemplateRenderer</strong> - Nunjucks template processing</li>
                <li><strong>MDXRenderer</strong> - Markdown with React components</li>
                <li><strong>ConfigLoader</strong> - Reads YAML specs and configs</li>
                <li><strong>CacheManager</strong> - Caches LLM responses</li>
            </ul>
        </div>
    </section>

    <!-- Slide 6: Execution Flow (Part 1) -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">How Execution Works (Steps 1-4)</h2>
        <div class="fill-height">
            <ul class="text-lg" style="color: #cbd5e1;">
                <li><strong>1.</strong> Load pipeline spec and config files</li>
                <li><strong>2.</strong> Run processor.ts to fetch data</li>
                <li><strong>3.</strong> Render prompt templates with data</li>
                <li><strong>4.</strong> Call LLM with prompt for enrichment</li>
            </ul>
        </div>
    </section>

    <!-- Slide 7: Execution Flow (Part 2) -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">How Execution Works (Steps 5-7)</h2>
        <div class="fill-height">
            <ul class="text-lg" style="color: #cbd5e1;">
                <li><strong>5.</strong> Build context with inputs, data, and LLM output</li>
                <li><strong>6.</strong> Render templates using Nunjucks</li>
                <li><strong>7.</strong> Save reports in requested formats (HTML, PDF, MD)</li>
            </ul>
        </div>
    </section>

    <!-- Slide 8: Data Flow Diagram (Text) -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">Data Flow</h2>
        <div class="fill-height" style="font-size: 0.95rem; line-height: 2;">
            <p style="color: #cbd5e1; margin-bottom: 0.5rem;">User Input</p>
            <p style="color: #94a3b8; margin-bottom: 1rem;">↓</p>
            <p style="color: #cbd5e1; margin-bottom: 0.5rem;">Processor (fetch data) → Prompts (render) → LLM (generate)</p>
            <p style="color: #94a3b8; margin-bottom: 1rem;">↓</p>
            <p style="color: #cbd5e1; margin-bottom: 0.5rem;">Template Rendering</p>
            <p style="color: #94a3b8; margin-bottom: 1rem;">↓</p>
            <p style="color: #38bdf8; font-weight: bold;">Final Report (Multiple Formats)</p>
        </div>
    </section>

    <!-- Slide 9: Error Handling -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">Error Handling</h2>
        <div class="fill-height">
            <ul class="text-lg" style="color: #cbd5e1;">
                <li>Structured <code>DProcError</code> class with context</li>
                <li>User-friendly error messages</li>
                <li>Error codes and suggested fixes</li>
                <li>Job cancellation support with AbortController</li>
            </ul>
        </div>
    </section>

    <!-- Slide 10: Storage Architecture -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">Storage: File-Based</h2>
        <div class="fill-height">
            <ul class="text-lg" style="color: #cbd5e1;">
                <li>No database - uses file system only</li>
                <li>Pipelines organized in <code>pipelines/</code> directory</li>
                <li>Outputs saved to <code>output/reports/</code></li>
                <li>Data bundles stored in <code>output/bundles/</code></li>
            </ul>
        </div>
    </section>

    <!-- Slide 11: Monorepo Structure -->
    <section class="slide p-16 col slide-content">
        <h2 class="mb-6">Monorepo Layout</h2>
        <div class="fill-height">
            <ul class="text-lg" style="color: #cbd5e1;">
                <li><code>packages/dproc-core</code> - Main framework logic</li>
                <li><code>packages/dproc-types</code> - TypeScript type definitions</li>
                <li><code>apps/dproc-web</code> - Next.js web interface</li>
                <li><code>pipelines/</code> - User-created pipelines</li>
            </ul>
        </div>
    </section>

    <!-- Slide 12: Thank You -->
    <section class="slide p-16 col center slide-title">
        <h2 class="text-4xl mb-6" style="color: #38bdf8;">Architecture Summary</h2>
        <p class="text-xl" style="color: #cbd5e1;">Simple, modular, and extensible</p>
    </section>

</body>
</html>